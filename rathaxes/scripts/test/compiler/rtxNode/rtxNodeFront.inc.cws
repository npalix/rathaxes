#if !existFunction(rtxNodeFront_version)

function rtxNodeFront_version()
{return "1.0";}

function rtxNodeConfig(local_node   : node,
                       out_ref_body : reference)
{
    rtxNode(local_node);
    local_node.type = "__rtx_config__";

    insert local_node.body;
    cnormNodeBlock(local_node.body);
    out_ref_body = local_node.body;

    return true;
}

function rtxNodeConfigField(local_node  : node,
                            out_ref_id  : reference,
                            out_ref_val : reference)
{
    rtxNode(local_node);
    local_node.type = "__rtx_config_field__";

    insert local_node.id;
    insert local_node.val;

    out_ref_id = local_node.id;
    out_ref_val = local_node.val;

    return true;
}

function rtxNodeConfig_BodyAddField(local_node      : node,
                                    out_ref_field   : reference,
                                    out_ref_id      : reference,
                                    out_ref_val     : reference)
{
    if ((local_node#parent.type != "__rtx_config__"
         && local_node#parent.type != "__rtx_config_field__")
        || local_node.type != "__block__")
        return false;
    pushItem local_node.block;
    
    out_ref_field = local_node.block#back;
    
    return rtxNodeConfigField(out_ref_field, out_ref_id, out_ref_val);
}

function rtxNodeConfigField_Extend(local_node   : node,
                                   out_ref_body : reference)
{
    if (local_node.type != "__rtx_config_field__")
        return false;

    insert local_node.extension;
    cnormNodeBlock(local_node.extension);
    out_ref_body = local_node.extension;

    return true;
}

#end
